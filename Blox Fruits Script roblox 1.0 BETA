local ScreenGui = Instance.new("ScreenGui")
local MainFrame = Instance.new("Frame")
local BetaText = Instance.new("TextLabel")
local TeletransportesButton = Instance.new("TextButton")
local InfiniteYieldButton = Instance.new("TextButton")
local BloxFruitsScriptButton = Instance.new("TextButton")
local AllChestTweenButton = Instance.new("TextButton")
local TeletransportarFrutasButton = Instance.new("TextButton") -- Botón de Frutas
local BackButton = Instance.new("TextButton")
local CloseButton = Instance.new("TextButton")

-- Configuración del ScreenGui
ScreenGui.Parent = game.CoreGui
ScreenGui.Name = "CustomMenu"
ScreenGui.ResetOnSpawn = false

local player = game.Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- Crear el ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "ToggleGui"
screenGui.Parent = playerGui

-- Crear el botón
local toggleButton = Instance.new("ImageButton")
toggleButton.Name = "ToggleButton"
toggleButton.Parent = screenGui
toggleButton.AnchorPoint = Vector2.new(0.5, 0.5) -- Corregido
toggleButton.Size = UDim2.new(0.035, 0, 0.07, 0)
toggleButton.Position = UDim2.new(0.1, 0, 0.5, 0) -- Ajusta la posición inicial si es necesario
toggleButton.Image = "rbxassetid://128823460334294" -- Cambia este ID por el de tu imagen
toggleButton.BackgroundTransparency = 1

-- Referencia al Frame existente
local frame = MainFrame -- Cambia "NombreDeTuFrame" por el nombre exacto de tu Frame

toggleButton.Draggable = true
toggleButton.Active = true

-- Alternar visibilidad del Frame
toggleButton.MouseButton1Click:Connect(function()
    frame.Visible = not frame.Visible
end)

-- Configuración del MainFrame
MainFrame.Parent = ScreenGui
MainFrame.AnchorPoint = Vector2.new(0.5, 0.5) -- Corregido
MainFrame.Size = UDim2.new(0.44, 0, 0.455, 0) -- Menú más grande
MainFrame.Position = UDim2.new(0.5, 0, 0.5, 0)
MainFrame.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
MainFrame.BorderSizePixel = 0
MainFrame.Visible = true
MainFrame.Active = true
MainFrame.Draggable = true

-- Configuración de BetaText
BetaText.Parent = MainFrame
BetaText.AnchorPoint = Vector2.new(0.5, 0.5) -- Corregido
BetaText.Size = UDim2.new(0.07, 0, 0.07, 0)
BetaText.Position = UDim2.new(0.95, 0, 0.95, 0)
BetaText.Text = "Beta"
BetaText.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
BetaText.TextColor3 = Color3.fromRGB(130, 130, 130)
BetaText.TextSize = 10

-- Configuración de TeletransportesButton
TeletransportesButton.Parent = MainFrame
TeletransportesButton.AnchorPoint = Vector2.new(0.5, 0.5) -- Corregido
TeletransportesButton.Size = UDim2.new(0.4, 0, 0.17, 0)
TeletransportesButton.Position = UDim2.new(0.21, 0, 0.11, 0)
TeletransportesButton.Text = "Teletransportes"
TeletransportesButton.BackgroundColor3 = Color3.fromRGB(65, 65, 65)
TeletransportesButton.TextColor3 = Color3.new(1, 1, 1)
TeletransportesButton.Font = Enum.Font.SourceSansBold
TeletransportesButton.TextSize = 24

-- Configuración de InfiniteYieldButton
InfiniteYieldButton.Parent = MainFrame
InfiniteYieldButton.AnchorPoint = Vector2.new(0.5, 0.5) -- Corregido
InfiniteYieldButton.Size = UDim2.new(0.4, 0, 0.17, 0)
InfiniteYieldButton.Position = UDim2.new(0.65, 0, 0.11, 0)
InfiniteYieldButton.Text = "Infinite Yield"
InfiniteYieldButton.BackgroundColor3 = Color3.fromRGB(65, 65, 65)
InfiniteYieldButton.TextColor3 = Color3.new(1, 1, 1)
InfiniteYieldButton.Font = Enum.Font.SourceSansBold
InfiniteYieldButton.TextSize = 24

-- Configuración de BloxFruitsScriptButton
BloxFruitsScriptButton.Parent = MainFrame
BloxFruitsScriptButton.AnchorPoint = Vector2.new(0.5, 0.5) -- Corregido
BloxFruitsScriptButton.Size = UDim2.new(0.4, 0, 0.17, 0)
BloxFruitsScriptButton.Position = UDim2.new(0.21, 0, 0.3, 0)
BloxFruitsScriptButton.Text = "Blox Fruits Script"
BloxFruitsScriptButton.BackgroundColor3 = Color3.fromRGB(65, 65, 65)
BloxFruitsScriptButton.TextColor3 = Color3.new(1, 1, 1)
BloxFruitsScriptButton.Font = Enum.Font.SourceSansBold
BloxFruitsScriptButton.TextSize = 23

-- Configuración de AimLockBloxButton
local AimLockBloxButton = Instance.new("TextButton")
AimLockBloxButton.Parent = MainFrame
AimLockBloxButton.AnchorPoint = Vector2.new(0.5, 0.5) -- Corregido
AimLockBloxButton.Size = UDim2.new(0.4, 0, 0.17, 0)
AimLockBloxButton.Position = UDim2.new(0.65, 0, 0.3, 0) -- Ajusta la posición según sea necesario
AimLockBloxButton.Text = "AimLock Blox"
AimLockBloxButton.BackgroundColor3 = Color3.fromRGB(65, 65, 65)
AimLockBloxButton.TextColor3 = Color3.new(1, 1, 1)
AimLockBloxButton.Font = Enum.Font.SourceSansBold
AimLockBloxButton.TextSize = 24

-- AimLockNPCButton Configuration
local AimLockNPCButton = Instance.new("TextButton")
AimLockNPCButton.Parent = MainFrame
AimLockNPCButton.AnchorPoint = Vector2.new(0.5, 0.5) -- Corrected
AimLockNPCButton.Size = UDim2.new(0.4, 0, 0.17, 0)
AimLockNPCButton.Position = UDim2.new(0.21, 0, 0.47, 0) -- Adjust position below "Blox Fruits Script"
AimLockNPCButton.Text = "AimLock NPC"
AimLockNPCButton.BackgroundColor3 = Color3.fromRGB(65, 65, 65)
AimLockNPCButton.TextColor3 = Color3.new(1, 1, 1)
AimLockNPCButton.Font = Enum.Font.SourceSansBold
AimLockNPCButton.TextSize = 24

-- Configuración de AllChestTweenButton
AllChestTweenButton.Parent = MainFrame
AllChestTweenButton.AnchorPoint = Vector2.new(0.5, 0.5) -- Corregido
AllChestTweenButton.Size = UDim2.new(0.4, 0, 0.17, 0)
AllChestTweenButton.Position = UDim2.new(0.3, 0, 0.11, 0)
AllChestTweenButton.Text = "Todos Los Cofres/ OFF"
AllChestTweenButton.BackgroundColor3 = Color3.fromRGB(65, 65, 65)
AllChestTweenButton.TextColor3 = Color3.new(1, 1, 1)
AllChestTweenButton.Font = Enum.Font.SourceSansBold
AllChestTweenButton.TextSize = 24
AllChestTweenButton.Visible = false

-- Configuración de TeletransportarFrutasButton
TeletransportarFrutasButton.Parent = MainFrame
TeletransportarFrutasButton.AnchorPoint = Vector2.new(0.5, 0.5) -- Corregido
TeletransportarFrutasButton.Size = UDim2.new(0.4, 0, 0.17, 0)
TeletransportarFrutasButton.Position = UDim2.new(0.705, 0, 0.11, 0)
TeletransportarFrutasButton.Text = "Teletransportar a Frutas/ OFF"
TeletransportarFrutasButton.BackgroundColor3 = Color3.fromRGB(65, 65, 65)
TeletransportarFrutasButton.TextColor3 = Color3.new(1, 1, 1)
TeletransportarFrutasButton.Font = Enum.Font.SourceSansBold
TeletransportarFrutasButton.TextSize = 23
TeletransportarFrutasButton.Visible = false

-- Configuración de TeletransportarseAJugadorButton
local TeletransportarseAJugadorButton = Instance.new("TextButton")
TeletransportarseAJugadorButton.AnchorPoint = Vector2.new(0.5, 0.5) -- Corregido
TeletransportarseAJugadorButton.Parent = MainFrame
TeletransportarseAJugadorButton.Size = UDim2.new(0.4, 0, 0.17, 0)
TeletransportarseAJugadorButton.Position = UDim2.new(0.3, 0, 0.28, 0) -- Ajusta la posición debajo de los botones anteriores
TeletransportarseAJugadorButton.Text = "Teletransportarse a Jugador"
TeletransportarseAJugadorButton.BackgroundColor3 = Color3.fromRGB(65, 65, 65)
TeletransportarseAJugadorButton.TextColor3 = Color3.new(1, 1, 1)
TeletransportarseAJugadorButton.Font = Enum.Font.SourceSansBold
TeletransportarseAJugadorButton.TextSize = 20
TeletransportarseAJugadorButton.TextWrap = true  
TeletransportarseAJugadorButton.TextWrapped = true
TeletransportarseAJugadorButton.Visible = false

-- Configuración de TeletransportarseAJugadorTextBox
local TeletransportarseAJugadorTextBox = Instance.new("TextBox")
TeletransportarseAJugadorTextBox.Parent = MainFrame
TeletransportarseAJugadorTextBox.AnchorPoint = Vector2.new(0.5, 0.5) -- Corregido
TeletransportarseAJugadorTextBox.Size = UDim2.new(0.4, 0, 0.12, 0)
TeletransportarseAJugadorTextBox.Position = UDim2.new(0.3, 0, 0.4, 0)  -- Debajo del botón
TeletransportarseAJugadorTextBox.Text = "Escribe Aqui El Nombre"
TeletransportarseAJugadorTextBox.BackgroundColor3 = Color3.fromRGB(65, 65, 65)
TeletransportarseAJugadorTextBox.TextColor3 = Color3.new(1, 1, 1)
TeletransportarseAJugadorTextBox.Font = Enum.Font.SourceSansBold
TeletransportarseAJugadorTextBox.TextSize = 20
TeletransportarseAJugadorTextBox.TextWrap = true  
TeletransportarseAJugadorTextBox.TextWrapped = true
TeletransportarseAJugadorTextBox.ClearTextOnFocus = true  -- Limpia el texto cuando el jugador hace clic en el cuadro
TeletransportarseAJugadorTextBox.Visible = false

-- Configuración de BackButton
BackButton.Parent = MainFrame
BackButton.AnchorPoint = Vector2.new(0.5, 0.5) -- Corregido
BackButton.Size = UDim2.new(0.085, 0, 0.16, 0)
BackButton.Position = UDim2.new(0.05, 0, 0.1, 0)
BackButton.Text = "<"
BackButton.BackgroundColor3 = Color3.fromRGB(255, 85, 85)
BackButton.TextColor3 = Color3.new(1, 1, 1)
BackButton.Font = Enum.Font.SourceSansBold
BackButton.TextSize = 20
BackButton.Visible = false

-- Configuración de CloseButton
CloseButton.Parent = MainFrame
CloseButton.AnchorPoint = Vector2.new(0.5, 0.5) -- Corregido
CloseButton.Size = UDim2.new(0.085, 0, 0.16, 0)
CloseButton.Position = UDim2.new(0.95, 0, 0.1, 0) -- Esquina superior derecha
CloseButton.Text = "X"
CloseButton.BackgroundColor3 = Color3.fromRGB(255, 85, 85)
CloseButton.TextColor3 = Color3.new(1, 1, 1)
CloseButton.Font = Enum.Font.SourceSansBold
CloseButton.TextSize = 24
CloseButton.Visible = true

-- Funcionalidad del botón Infinite Yield
InfiniteYieldButton.MouseButton1Click:Connect(function()
    loadstring(game:HttpGet('https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source'))()
end)

BloxFruitsScriptButton.MouseButton1Click:Connect(function()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/Lucasbekk3315-code/Blox-Fruits-redz-hub/refs/heads/main/Script%20blox%20fruits%20roblox%20redz%20hub"))()
end)

AimLockBloxButton.MouseButton1Click:Connect(function()
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Camera = workspace.CurrentCamera
local StarterGui = game:GetService("StarterGui")
local LocalPlayer = Players.LocalPlayer

local AimbotActivado = false
local TeclaDeAimbot = Enum.KeyCode.E
local Objetivo = nil
local TeclaAsignada = false
local PantallaGui = nil
local ClickDerechoAsignado = false

-- Función para enviar notificaciones
local function Notificar(titulo, texto, duracion)
    pcall(function()
        StarterGui:SetCore("SendNotification", {
            Title = titulo,
            Text = texto,
            Duration = duracion or 3
        })
    end)
end

-- Verificar si un jugador es válido (siempre devuelve true para apuntar a cualquiera)
local function EsEnemigo(jugador)
    return true
end

-- Obtener el jugador más cercano al mouse
local function ObtenerJugadorMasCercanoAlMouse()
    local posicionMouse = UserInputService:GetMouseLocation()
    local jugadorMasCercano = nil
    local distanciaMasCercana = math.huge

    for _, jugador in ipairs(Players:GetPlayers()) do
        if jugador ~= LocalPlayer and EsEnemigo(jugador) and jugador.Character and jugador.Character:FindFirstChild("HumanoidRootPart") then
            local torso = jugador.Character.HumanoidRootPart
            local posicionPantalla, enPantalla = Camera:WorldToScreenPoint(torso.Position)

            if enPantalla then
                local distancia = (Vector2.new(posicionPantalla.X, posicionPantalla.Y) - posicionMouse).Magnitude
                if distancia < distanciaMasCercana then
                    distanciaMasCercana = distancia
                    jugadorMasCercano = jugador
                end
            end
        end
    end

    return jugadorMasCercano
end

-- Apuntar al objetivo
local function ApuntarA(parteObjetivo)
    if parteObjetivo then
        Camera.CFrame = CFrame.new(Camera.CFrame.Position, parteObjetivo.Position)
    end
end

-- Validar el objetivo
local function ValidarObjetivo(jugador)
    if jugador and jugador.Character and jugador.Character:FindFirstChild("HumanoidRootPart") then
        return true -- Siempre consideramos válido el objetivo actual
    end
    return false
end

-- Actualizar constantemente el objetivo mientras el aimbot está activado
RunService.Heartbeat:Connect(function()
    if AimbotActivado then
        if not Objetivo or not ValidarObjetivo(Objetivo) then
            Objetivo = ObtenerJugadorMasCercanoAlMouse()
        end

        if Objetivo then
            local parteObjetivo = Objetivo.Character:FindFirstChild("HumanoidRootPart")
            if parteObjetivo then
                ApuntarA(parteObjetivo)
            end
        end
    end
end)

-- Detectar cuando se presiona la tecla de activación
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end

    -- Verificar si se presionó la tecla asignada o el clic derecho o el botón 4 o 5
    if TeclaAsignada and input.UserInputType == Enum.UserInputType.Keyboard then
        -- Verifica si la tecla presionada coincide con la tecla asignada
        if input.KeyCode == TeclaDeAimbot then
            AimbotActivado = not AimbotActivado
            if not AimbotActivado then
                Objetivo = nil -- Limpiar el objetivo cuando se desactiva
            end
            Notificar("Aimbot", AimbotActivado and "Aimbot Activado" or "Aimbot Desactivado", 1)
        end
    elseif ClickDerechoAsignado and input.UserInputType == Enum.UserInputType.MouseButton2 then
        -- Activar/desactivar el aimbot con el clic derecho
        AimbotActivado = not AimbotActivado
        if not AimbotActivado then
            Objetivo = nil -- Limpiar el objetivo cuando se desactiva
        end
        Notificar("Aimbot", AimbotActivado and "Aimbot Activado" or "Aimbot Desactivado", 1)
    elseif input.UserInputType == Enum.UserInputType.MouseButton4 then
        -- Activar/desactivar el aimbot con el botón 4 del mouse
        if TeclaAsignada and TeclaDeAimbot == Enum.UserInputType.MouseButton4 then
            AimbotActivado = not AimbotActivado
            if not AimbotActivado then
                Objetivo = nil -- Limpiar el objetivo cuando se desactiva
            end
            Notificar("Aimbot", AimbotActivado and "Aimbot Activado" or "Aimbot Desactivado", 1)
        end
    elseif input.UserInputType == Enum.UserInputType.MouseButton5 then
        -- Activar/desactivar el aimbot con el botón 5 del mouse
        if TeclaAsignada and TeclaDeAimbot == Enum.UserInputType.MouseButton5 then
            AimbotActivado = not AimbotActivado
            if not AimbotActivado then
                Objetivo = nil -- Limpiar el objetivo cuando se desactiva
            end
            Notificar("Aimbot", AimbotActivado and "Aimbot Activado" or "Aimbot Desactivado", 1)
        end
    end
end)

-- Crear el menú para asignar la tecla
local function CrearMenuDeTecla()
    PantallaGui = Instance.new("ScreenGui")
    PantallaGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")
    
    local Marco = Instance.new("Frame")
    Marco.Size = UDim2.new(0, 300, 0, 150)
    Marco.Position = UDim2.new(0.5, -150, 0.5, -75)
    Marco.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    Marco.Parent = PantallaGui
    Marco.Active = true
    Marco.Draggable = true
    
    local Titulo = Instance.new("TextLabel")
    Titulo.Size = UDim2.new(1, 0, 0, 30)
    Titulo.Text = "AimLock Blox"
    Titulo.TextColor3 = Color3.fromRGB(255, 255, 255)
    Titulo.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    Titulo.TextSize = 20
    Titulo.Parent = Marco

    local BotonCerrar = Instance.new("TextButton")
    BotonCerrar.Size = UDim2.new(0, 30, 0, 30)
    BotonCerrar.Position = UDim2.new(1, -35, 0, 5)
    BotonCerrar.Text = "X"
    BotonCerrar.TextColor3 = Color3.fromRGB(255, 255, 255)
    BotonCerrar.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
    BotonCerrar.Parent = Marco

    BotonCerrar.MouseButton1Click:Connect(function()
        AimbotActivado = false
        TeclaAsignada = false
        TeclaDeAimbot = nil
        ClickDerechoAsignado = false
        if PantallaGui then
            PantallaGui:Destroy()
        end
        Notificar("Aimbot", "Aimbot Desactivado y Menú Cerrado", 3)
    end)

    local CajaTexto = Instance.new("TextBox")
    CajaTexto.Size = UDim2.new(0, 260, 0, 40)
    CajaTexto.Position = UDim2.new(0, 20, 0, 40)
    CajaTexto.Text = "Presiona Aqui."
    CajaTexto.PlaceholderText = "Presiona una tecla... o escribe 'click' para asignar el clic derecho"
    CajaTexto.TextColor3 = Color3.fromRGB(255, 255, 255)
    CajaTexto.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    CajaTexto.Parent = Marco
    

    CajaTexto.FocusLost:Connect(function(enterPressed)
        if enterPressed then
            local tecla = CajaTexto.Text:upper()
            if tecla == "CLICK" then
                ClickDerechoAsignado = true
                TeclaDeAimbot = Enum.KeyCode.Unknown -- Desactivar asignación de tecla
                TeclaAsignada = true
                Notificar("Tecla Aimbot", "Clic derecho asignado para activar el aimbot.", 3)
            elseif tecla == "BOTON4" then
                TeclaDeAimbot = Enum.UserInputType.MouseButton4 -- Asignar el botón 4 del mouse
                TeclaAsignada = true
                ClickDerechoAsignado = false
                Notificar("Tecla Aimbot", "Botón 4 del mouse asignado para activar el aimbot.", 3)
            elseif tecla == "BOTON5" then
                TeclaDeAimbot = Enum.UserInputType.MouseButton5 -- Asignar el botón 5 del mouse
                TeclaAsignada = true
                ClickDerechoAsignado = false
                Notificar("Tecla Aimbot", "Botón 5 del mouse asignado para activar el aimbot.", 3)
            else
                local teclaValida = false
                -- Validar si la tecla es válida
                for _, keyCode in pairs(Enum.KeyCode:GetEnumItems()) do
                    if keyCode.Name == tecla then
                        TeclaDeAimbot = keyCode
                        TeclaAsignada = true
                        ClickDerechoAsignado = false
                        Notificar("Tecla Aimbot", "Tecla asignada a: " .. tecla, 3)
                        teclaValida = true
                        break
                    end
                end
                if not teclaValida then
                    Notificar("Error", "Tecla inválida, intenta de nuevo.", 3)
                end
            end
        end
    end)
end


--- Controlar el cierre y apertura del menú con Ctrl derecho
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    if input.KeyCode == Enum.KeyCode.RightControl then
        if PantallaGui and PantallaGui:FindFirstChild("Frame") then
            local Marco = PantallaGui:FindFirstChild("Frame")
            Marco.Visible = not Marco.Visible
        end
    end
end)

CrearMenuDeTecla()
Notificar("Aimbot", "Aimbot Inicializado. Asigna una tecla o escribe 'click' para usar clic derecho, Ctrl Derecho Para togglear Visibilidad.", 10)
end)



-- English AimLockNPCButton --
local menuOpen = false  -- Variable para verificar si el menú ya está abierto

AimLockNPCButton.MouseButton1Click:Connect(function()
    if menuOpen then
        return  -- Si el menú ya está abierto, no hacer nada
    end

    menuOpen = true  -- Marcamos que el menú está abierto

    local Players = game:GetService("Players")
    local RunService = game:GetService("RunService")
    local UserInputService = game:GetService("UserInputService")
    local Camera = workspace.CurrentCamera
    local StarterGui = game:GetService("StarterGui")
    local LocalPlayer = Players.LocalPlayer

    local AimbotActivated = false
    local AimbotKey = Enum.KeyCode.E
    local Target = nil
    local KeyAssigned = false
    local GuiScreen = nil
    local RightClickAssigned = false

    -- Function to send notifications
    local function Notify(title, text, duration)
        pcall(function()
            StarterGui:SetCore("SendNotification", {
                Title = title,
                Text = text,
                Duration = duration or 3
            })
        end)
    end

    -- Check if an NPC is valid (all NPCs in "workspace.Enemies" are considered enemies)
    local function IsEnemy(npc)
        return npc and npc:FindFirstChild("HumanoidRootPart")
    end

    -- Get the closest NPC to the mouse
    local function GetClosestNpcToMouse()
        local mousePosition = UserInputService:GetMouseLocation()
        local closestNpc = nil
        local closestDistance = math.huge

        for _, npc in ipairs(workspace.Enemies:GetChildren()) do
            if IsEnemy(npc) then
                local torso = npc.HumanoidRootPart
                local screenPosition, onScreen = Camera:WorldToScreenPoint(torso.Position)

                if onScreen then
                    local distance = (Vector2.new(screenPosition.X, screenPosition.Y) - mousePosition).Magnitude
                    if distance < closestDistance then
                        closestDistance = distance
                        closestNpc = npc
                    end
                end
            end
        end

        return closestNpc
    end

    -- Aim at the target (NPC)
    local function AimAt(targetPart)
        if targetPart then
            Camera.CFrame = CFrame.new(Camera.CFrame.Position, targetPart.Position)
        end
    end

    -- Validate the target (NPC)
    local function ValidateTarget(npc)
        if npc and npc:FindFirstChild("HumanoidRootPart") then
            return true
        end
        return false
    end

    -- Deactivate aimbot if the NPC's humanoid health is 0, but instead of deactivating, switch to the next closest NPC
local function CheckNpcHealth()
    if Target then
        local humanoid = Target:FindFirstChild("Humanoid")
        if humanoid and humanoid.Health == 0 then
            -- Notify that the current NPC is eliminated
            Notify("Aimbot", "NPC eliminado, cambiando de objetivo.", 3)
            -- Find a new target
            Target = GetClosestNpcToMouse()
        end
    end
end

    -- Constantly update the target while the aimbot is activated
    RunService.Heartbeat:Connect(function()
        if AimbotActivated then
            if not Target or not ValidateTarget(Target) then
                Target = GetClosestNpcToMouse()
            end

            if Target then
                local targetPart = Target:FindFirstChild("HumanoidRootPart")
                if targetPart then
                    AimAt(targetPart)
                end
            end

            -- Check if the NPC has health 0 and deactivate the aimbot
            CheckNpcHealth()
        end
    end)

    -- Detect when the activation key is pressed
    UserInputService.InputBegan:Connect(function(input, gameProcessed)
        if gameProcessed then return end

        -- Check if the assigned key or right-click or mouse button 4 or 5 is pressed
        if KeyAssigned and input.UserInputType == Enum.UserInputType.Keyboard then
            -- Check if the pressed key matches the assigned key
            if input.KeyCode == AimbotKey then
                AimbotActivated = not AimbotActivated
                if not AimbotActivated then
                    Target = nil -- Clear the target when deactivated
                end
                Notify("Aimbot", AimbotActivated and "Aimbot Activado" or "Aimbot Desactivado", 1)
            end
        elseif RightClickAssigned and input.UserInputType == Enum.UserInputType.MouseButton2 then
            -- Toggle aimbot with right-click
            AimbotActivated = not AimbotActivated
            if not AimbotActivated then
                Target = nil -- Clear the target when deactivated
            end
            Notify("Aimbot", AimbotActivated and "Aimbot Activado" or "Aimbot Desactivado", 1)
        elseif input.UserInputType == Enum.UserInputType.MouseButton4 then
            -- Toggle aimbot with mouse button 4
            if KeyAssigned and AimbotKey == Enum.UserInputType.MouseButton4 then
                AimbotActivated = not AimbotActivated
                if not AimbotActivated then
                    Target = nil -- Clear the target when deactivated
                end
                Notify("Aimbot", AimbotActivated and "Aimbot Activado" or "Aimbot Desactivado", 1)
            end
        elseif input.UserInputType == Enum.UserInputType.MouseButton5 then
            -- Toggle aimbot with mouse button 5
            if KeyAssigned and AimbotKey == Enum.UserInputType.MouseButton5 then
                AimbotActivated = not AimbotActivated
                if not AimbotActivated then
                    Target = nil -- Clear the target when deactivated
                end
                Notify("Aimbot", AimbotActivated and "Aimbot Activado" or "Aimbot Desactivado", 1)
            end
        end
    end)

    -- Create the key assignment menu
    local function CreateKeyMenu()
        GuiScreen = Instance.new("ScreenGui")
        GuiScreen.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")
        
        local Frame = Instance.new("Frame")
        Frame.Size = UDim2.new(0, 300, 0, 150)
        Frame.Position = UDim2.new(0.5, -150, 0.5, -75)
        Frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
        Frame.Parent = GuiScreen
        Frame.Active = true
        Frame.Draggable = true
        
        local Title = Instance.new("TextLabel")
        Title.Size = UDim2.new(1, 0, 0, 30)
        Title.Text = "AimLock NPC"
        Title.TextColor3 = Color3.fromRGB(255, 255, 255)
        Title.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
        Title.TextSize = 20
        Title.Parent = Frame

        local CloseButton = Instance.new("TextButton")
        CloseButton.Size = UDim2.new(0, 30, 0, 30)
        CloseButton.Position = UDim2.new(1, -35, 0, 5)
        CloseButton.Text = "X"
        CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
        CloseButton.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
        CloseButton.Parent = Frame

        CloseButton.MouseButton1Click:Connect(function()
            AimbotActivated = false
            KeyAssigned = false
            AimbotKey = nil
            RightClickAssigned = false
            if GuiScreen then
                GuiScreen:Destroy() -- Destroy the ScreenGui
            end
            if Frame then
                Frame:Destroy() -- Destroy the menu frame
            end
            Notify("Aimbot", "Aimbot Desactivado y Menú Cerrado", 3)
            menuOpen = false  -- Marcar que el menú está cerrado
        end)

        local TextBox = Instance.new("TextBox")
        TextBox.Size = UDim2.new(0, 260, 0, 40)
        TextBox.Position = UDim2.new(0, 20, 0, 40)
        TextBox.Text = "Press Here."
        TextBox.PlaceholderText = "Press a key... or type 'click' to assign right-click"
        TextBox.TextColor3 = Color3.fromRGB(255, 255, 255)
        TextBox.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
        TextBox.Parent = Frame
        
        TextBox.FocusLost:Connect(function(enterPressed)
            if enterPressed then
                local key = TextBox.Text:upper()
                if key == "CLICK" then
                    RightClickAssigned = true
                    AimbotKey = Enum.KeyCode.Unknown -- Disable key assignment
                    KeyAssigned = true
                    Notify("Aimbot Key", "Right-click assigned to activate aimbot.", 3)
                elseif key == "BUTTON4" then
                    AimbotKey = Enum.UserInputType.MouseButton4 -- Assign mouse button 4
                    KeyAssigned = true
                    RightClickAssigned = false
                    Notify("Aimbot Key", "Mouse button 4 assigned to activate aimbot.", 3)
                elseif key == "BUTTON5" then
                    AimbotKey = Enum.UserInputType.MouseButton5 -- Assign mouse button 5
                    KeyAssigned = true
                    RightClickAssigned = false
                    Notify("Aimbot Key", "Mouse button 5 assigned to activate aimbot.", 3)
                else
                    local validKey = false
                    -- Check if it's a valid key
                    for _, keyCode in pairs(Enum.KeyCode:GetEnumItems()) do
                        if keyCode.Name == key then
                            AimbotKey = keyCode
                            KeyAssigned = true
                            validKey = true
                            break
                        end
                    end
                    if validKey then
                        Notify("Aimbot Key", "Key assigned to activate aimbot.", 3)
                    else
                        Notify("Invalid Key", "The key you entered is not valid.", 3)
                    end
                end
            end
        end)
    end

    -- Create the key assignment menu when the AimLockNPCButton is clicked
    CreateKeyMenu()
end)




local TweenService = game:GetService("TweenService")
local Players = game:GetService("Players")
local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoidRootPart = character:WaitForChild("HumanoidRootPart")

local isTweening = false
local speed = 340 -- Velocidad equivalente a WalkSpeed 50 (ajustable)

-- Función para tween a una posición
local function tweenToPosition(destinationCFrame)
    if not humanoidRootPart then return end

    local distance = (humanoidRootPart.Position - destinationCFrame.Position).Magnitude
    local time = distance / speed

    local tweenInfo = TweenInfo.new(time, Enum.EasingStyle.Linear)
    local tween = TweenService:Create(humanoidRootPart, tweenInfo, {CFrame = destinationCFrame})

    tween:Play()
    tween.Completed:Wait()
end

-- Función para teletransportarse directamente
local function teleportToPosition(destinationCFrame)
    if not humanoidRootPart then return end
    humanoidRootPart.CFrame = destinationCFrame
end

-- Función para autocompletar el nombre del jugador
local function AutocompletarNombre(parteDelNombre)
    for _, player in ipairs(Players:GetPlayers()) do
        if player.Name:lower():find(parteDelNombre:lower()) then
            return player.Name
        end
    end
    return nil
end

-- Evento al presionar Enter en el TextBox
TeletransportarseAJugadorTextBox.FocusLost:Connect(function(enterPressed)
    if enterPressed then
        local textoIngresado = TeletransportarseAJugadorTextBox.Text
        local nombreCompleto = AutocompletarNombre(textoIngresado)

        if nombreCompleto then
            TeletransportarseAJugadorTextBox.Text = nombreCompleto
        else
            warn("No se encontró un jugador con ese nombre.")
        end
    end
end)

-- Configuración del botón
TeletransportarseAJugadorButton.MouseButton1Click:Connect(function()
    if isTweening then
        return -- Evitar múltiples ejecuciones si ya está tweening
    end

    local textoIngresado = TeletransportarseAJugadorTextBox.Text
    local nombreCompleto = AutocompletarNombre(textoIngresado)

    if nombreCompleto then
        TeletransportarseAJugadorTextBox.Text = nombreCompleto
        local targetPlayer = Players:FindFirstChild(nombreCompleto)

        if targetPlayer and targetPlayer.Character and targetPlayer.Character:FindFirstChild("HumanoidRootPart") then
            isTweening = true
            local targetHumanoidRootPart = targetPlayer.Character.HumanoidRootPart

            while true do
                local distance = (humanoidRootPart.Position - targetHumanoidRootPart.Position).Magnitude

                if distance <= 20 then -- Distancia mínima para considerar que "tocó" al jugador
                    print("Jugador tocado.")
                    break
                elseif distance <= 340 then
                    teleportToPosition(targetHumanoidRootPart.CFrame)
                else
                    tweenToPosition(targetHumanoidRootPart.CFrame)
                end

                task.wait(0.01) -- Pequeña espera para evitar sobrecargar el script
            end

            isTweening = false
        else
            warn("Jugador no encontrado o no tiene un personaje válido.")
        end
    else
        warn("No se encontró un jugador con ese nombre.")
    end
end)



-- Funcionalidad del botón Teletransportes
TeletransportesButton.MouseButton1Click:Connect(function()
    TeletransportesButton.Visible = false
    InfiniteYieldButton.Visible = false
    BloxFruitsScriptButton.Visible = false
    AimLockBloxButton.Visible = false
    AimLockNPCButton.Visible = false
    AllChestTweenButton.Visible = true
    TeletransportarseAJugadorButton.Visible = true
    TeletransportarseAJugadorTextBox.Visible = true
    TeletransportarFrutasButton.Visible = true
    BackButton.Visible = true
end)

local TweenService = game:GetService("TweenService")
local player = game.Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoidRootPart = character:WaitForChild("HumanoidRootPart")

local isTweening = false
local speed = 340 -- Velocidad equivalente a WalkSpeed 50 (ajustable)
local initialPosition -- Para guardar la posición inicial del jugador

-- Función para verificar si un objeto tiene un TouchInterest
local function hasTouchInterest(object)
    for _, descendant in ipairs(object:GetDescendants()) do
        if descendant:IsA("TouchTransmitter") then
            return true
        end
    end
    return false
end

local function tweenToPosition(destinationCFrame)
    if not humanoidRootPart then return end

    local distance = (humanoidRootPart.Position - destinationCFrame.Position).Magnitude
    local time = distance / speed

    local tweenInfo = TweenInfo.new(time, Enum.EasingStyle.Linear)
    local tween = TweenService:Create(humanoidRootPart, tweenInfo, {CFrame = destinationCFrame})

    tween:Play()
    tween.Completed:Wait()
end

local function teleportToPosition(destinationCFrame)
    if not humanoidRootPart then return end
    humanoidRootPart.CFrame = destinationCFrame
end

AllChestTweenButton.MouseButton1Click:Connect(function()
    if isTweening then
        -- Si el sistema está activo, desactívalo y regresa al jugador a su posición inicial
        isTweening = false
        AllChestTweenButton.Text = "Todos Los Cofres/ OFF"
        
        -- Verificar la distancia a la posición inicial antes de teletransportarse
        local distanceToInitial = (humanoidRootPart.Position - initialPosition.Position).Magnitude
        if distanceToInitial <= 340 then
            teleportToPosition(initialPosition)
        else
            tweenToPosition(initialPosition)
        end
        return
    end

    -- Guardar la posición inicial y activar el sistema
    initialPosition = humanoidRootPart.CFrame
    isTweening = true
    AllChestTweenButton.Text = "Todos Los Cofres/ ON"

    coroutine.wrap(function()
        -- Buscar directamente en workspace.Map
        local map = workspace.Map
        local closestChest = nil
        local closestDistance = math.huge -- Inicializar con un valor muy alto

        while isTweening do
            closestChest = nil
            closestDistance = math.huge -- Reiniciar la distancia más cercana

            -- Buscar el cofre más cercano con TouchInterest
            for _, object in ipairs(map:GetDescendants()) do
                if object:IsA("BasePart") and object.Name:find("^Chest") then
                    local distance = (humanoidRootPart.Position - object.Position).Magnitude

                    -- Verificar si el objeto tiene TouchInterest
                    if hasTouchInterest(object) and distance < closestDistance then
                        closestChest = object
                        closestDistance = distance
                    end
                end
            end

            -- Si encontramos un cofre con TouchInterest
            if closestChest then
                if closestDistance <= 340 then
                    -- Si está a 100 studs o menos, teletransportarse directamente
                    teleportToPosition(closestChest.CFrame)
                else
                    -- Si está más lejos de 100 studs, usar tween
                    tweenToPosition(closestChest.CFrame)
                end
                wait(0.3) -- Esperar un poco antes de seguir buscando

                -- Si el cofre ya no tiene TouchInterest, buscar el siguiente más cercano
                if not hasTouchInterest(closestChest) then
                    closestChest = nil
                end
            else
                -- Si no hay cofres con TouchInterest, esperar antes de buscar de nuevo
                wait(0.1)
            end
        end

        -- Cuando se desactiva, regresar a la posición inicial
        local distanceToInitial = (humanoidRootPart.Position - initialPosition.Position).Magnitude
        if distanceToInitial <= 340 then
            teleportToPosition(initialPosition)
        else
            tweenToPosition(initialPosition)
        end

        AllChestTweenButton.Text = "Todos Los Cofres/ OFF"
    end)()
end)


-- Función para teletransportarse a una Tool o Modelo, exactamente a la posición del objeto
local function TeletransportarAObjeto(objeto)
    -- Verificar si el objeto es una herramienta o un modelo con PrimaryPart
    if objeto:IsA("Tool") then
        -- Si es una herramienta, teletransportar al jugador a la posición de la herramienta
        local jugador = game.Players.LocalPlayer
        local personaje = jugador.Character
        local humanoidRootPart = personaje and personaje:FindFirstChild("HumanoidRootPart")

        if humanoidRootPart then
            -- Teletransportar al jugador a la posición exacta de la herramienta
            humanoidRootPart.CFrame = objeto.Handle.CFrame
            print("Teletransportado a la Tool: " .. objeto.Name) -- Depuración
        else
            print("No se encontró el HumanoidRootPart del jugador.") -- Depuración
        end
    elseif objeto:IsA("Model") and objeto.PrimaryPart then
        -- Si es un modelo, teletransportar al jugador a su PrimaryPart
        local jugador = game.Players.LocalPlayer
        local personaje = jugador.Character
        local humanoidRootPart = personaje and personaje:FindFirstChild("HumanoidRootPart")

        if humanoidRootPart then
            -- Teletransportar al jugador a la posición exacta del PrimaryPart del modelo
            humanoidRootPart.CFrame = objeto.PrimaryPart.CFrame
            print("Teletransportado al Modelo: " .. objeto.Name) -- Depuración
        else
            print("No se encontró el HumanoidRootPart del jugador.") -- Depuración
        end
    else
        print("El objeto no es una herramienta ni un modelo con PrimaryPart.") -- Depuración
    end
end

-- Función para teletransportarse a una Tool o Modelo, exactamente a la posición del objeto
local function TeletransportarAObjeto(objeto)
    -- Verificar si el objeto es una herramienta o un modelo con PrimaryPart
    if objeto:IsA("Tool") then
        -- Si es una herramienta, teletransportar al jugador a la posición de la herramienta
        local jugador = game.Players.LocalPlayer
        local personaje = jugador.Character
        local humanoidRootPart = personaje and personaje:FindFirstChild("HumanoidRootPart")

        if humanoidRootPart then
            -- Teletransportar al jugador a la posición exacta de la herramienta
            humanoidRootPart.CFrame = objeto.Handle.CFrame
            print("Teletransportado a la Tool: " .. objeto.Name) -- Depuración
        else
            print("No se encontró el HumanoidRootPart del jugador.") -- Depuración
        end
    elseif objeto:IsA("Model") and objeto.PrimaryPart then
        -- Si es un modelo, teletransportar al jugador a su PrimaryPart
        local jugador = game.Players.LocalPlayer
        local personaje = jugador.Character
        local humanoidRootPart = personaje and personaje:FindFirstChild("HumanoidRootPart")

        if humanoidRootPart then
            -- Teletransportar al jugador a la posición exacta del PrimaryPart del modelo
            humanoidRootPart.CFrame = objeto.PrimaryPart.CFrame
            print("Teletransportado al Modelo: " .. objeto.Name) -- Depuración
        else
            print("No se encontró el HumanoidRootPart del jugador.") -- Depuración
        end
    else
        print("El objeto no es una herramienta ni un modelo con PrimaryPart.") -- Depuración
    end
end

-- Funcionalidad del botón de Teletransportar a Frutas
TeletransportarFrutasButton.MouseButton1Click:Connect(function()
    if TeletransportarFrutasButton.Text == "Teletransportar a Frutas/ OFF" then
        TeletransportarFrutasButton.Text = "Teletransportar a Frutas/ ON"
        print("Teletransporte activado.") -- Depuración
        
        -- Activar la búsqueda de frutas en Workspace
        while TeletransportarFrutasButton.Text == "Teletransportar a Frutas/ ON" do
            -- Comprobar si hay algún objeto con "Fruit" en su nombre
            for _, child in pairs(workspace:GetChildren()) do
                if string.lower(child.Name):find("fruit") then
                    print("Objeto encontrado: " .. child.Name) -- Depuración
                    TeletransportarAObjeto(child)
                    break -- Teletransportarse solo a la primera fruta que encuentre
                end
            end
            wait(0.05) -- Esperar un segundo antes de comprobar nuevamente
        end
    else
        TeletransportarFrutasButton.Text = "Teletransportar a Frutas/ OFF"
        print("Teletransporte desactivado.") -- Depuración
    end
end)

-- Detectar cuando se agrega un nuevo hijo a Workspace
workspace.ChildAdded:Connect(function(child)
    -- Verificar si el nombre del nuevo hijo contiene "fruit" (sin importar mayúsculas/minúsculas)
    if string.lower(child.Name):find("fruit") then
        print("Nuevo objeto agregado: " .. child.Name) -- Depuración
        -- Verificar si el teletransporte está activado
        if TeletransportarFrutasButton.Text == "Teletransportar a Frutas/ ON" then
            -- Teletransportar al jugador a la posición del objeto recién agregado
            TeletransportarAObjeto(child)
        end
    end
end)


-- Funcionalidad del botón de regreso
BackButton.MouseButton1Click:Connect(function()
    AllChestTweenButton.Visible = false
    TeletransportarFrutasButton.Visible = false
    TeletransportarseAJugadorButton.Visible = false
    TeletransportarseAJugadorTextBox.Visible = false
    BackButton.Visible = false
    TeletransportesButton.Visible = true
    InfiniteYieldButton.Visible = true
    BloxFruitsScriptButton.Visible = true
    AimLockBloxButton.Visible = true
    AimLockNPCButton.Visible = true
end)

-- Funcionalidad del botón de cierre (X)
CloseButton.MouseButton1Click:Connect(function()
    ScreenGui:Destroy()
    screenGui:Destroy()
end)

-- Controlar el cierre y apertura del menú con Alt
local UserInputService = game:GetService("UserInputService")
local isAltPressed = false -- Estado para evitar que se activen múltiples eventos al mantener Alt

UserInputService.InputBegan:Connect(function(input, isProcessed)
    if isProcessed then return end -- Ignorar si el input ya fue procesado
    if input.KeyCode == Enum.KeyCode.LeftAlt then
        if not isAltPressed then
            isAltPressed = true
            MainFrame.Visible = not MainFrame.Visible
        end
    end
end)

UserInputService.InputEnded:Connect(function(input)
    if input.KeyCode == Enum.KeyCode.LeftAlt then
        isAltPressed = false
    end
end)

wait(1)

game.StarterGui:SetCore("SendNotification", {
    Title = "Leelo completo.";
    Text = "Gracias por usar mi script, Para poder minimizarlo presiona *Alt* y para agrandarlo Presionalo de nuevo, eso es todo Gracias.";
    Duration = 10;
})
